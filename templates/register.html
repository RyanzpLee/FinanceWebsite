{% extends 'layout.html' %}

{% block title %}
    Register
{% endblock %}

{% block main %}


    <div class="intro">
        <h3 class="m-4"> Welcome to my Finance Web App</h4>
        <h5 class="m-4">Users can virtually 'buy' and 'sell' stocks and add to your portfolio</h5> 
        
    </div>


    <form action="/register" method="POST">
        <div class="form-group">
            <input autocomplete="off" autofocus class="form-control" name="username" placeholder="Username" type="text" required pattern=".*\S.*">
        </div>
        <div class="form-group">
            <input class="form-control" id="password" name="password" placeholder="Password" type="password" required pattern="^(?=.*[A-Z])(?=.*[a-z])(?=.*\d).{8,}$">
        </div>
        <div class="form-group">
            <input class="form-control" name="confirmation" placeholder="Repeat Password" type="password" required pattern=".*\S.*">
        </div>
        <button class="btn btn-primary" type="submit">Register</button>
    </form>


    <div id="message">
        <h3>Password must contain the following:</h3>
        <p id="letter" class="invalid">A lowercase letter</p>
        <p id="capital" class="invalid">A uppercase letter</p>
        <p id="number" class="invalid">A number</p>
        <!-- <p id="special" class="invalid">A special character</p> -->
        <p id="length" class="invalid">Minimum 8 characters</p>
    </div>   
    
    <script>
        let input = document.querySelector("#password");
        let letter = document.querySelector("#letter");
        let capital = document.querySelector("#capital");
        let number = document.querySelector("#number");
        // let special = document.querySelector("#special");
        let length = document.querySelector("#length");
        let message = document.querySelector("#message");

        input.onfocus = function () {
            message.style.display = "block";
        }

        input.onblur = function() {
            message.style.display = "none";
        }

        input.onkeyup = function() {
            // Validate lower case
            let lowerCaseLetters = /[a-z]/g;
            if (input.value.match(lowerCaseLetters)) {
                letter.classList.remove("invalid");
                letter.classList.add("valid");
            } else {
                letter.classList.remove("valid");
                letter.classList.add("invalid")
            }

            // Validate uppercase
            let upperCaseLetters = /[A-Z]/g;
            if (input.value.match(upperCaseLetters)) {
                capital.classList.remove("invalid");
                capital.classList.add("valid");
            } else {
                capital.classList.remove("valid");
                capital.classList.add("invalid")
            }

            // Validate numbers
            let numbers = /[0-9]/g;
            if (input.value.match(numbers)) {
                number.classList.remove("invalid");
                number.classList.add("valid");
            } else {
                number.classList.remove("valid");
                number.classList.add("invalid")
            }

            // Validate length
            if (input.value.length >= 8) {
                length.classList.remove("invalid");
                length.classList.add("valid");
            } else {
                length.classList.remove("valid");
                length.classList.add("invalid")
            }
            

        }
    </script>
{% endblock %}